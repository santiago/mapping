{"ts":1348783845342,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var everyauth = require('everyauth');\n\neveryauth.helpExpress(app);\neveryauth.debug = true;\n\nvar usersByFbId = {};\nvar usersById = {};\nvar usersByGoogleId = {};\n\nvar nextUserId = 0;\n\nfunction addUser (source, sourceUser) {\n    var user;\n    if (arguments.length === 1) { // password-based\n    user = sourceUser = source;\n\tuser.id = ++nextUserId;\n\treturn usersById[nextUserId] = user;\n    } else { // non-password-based\n\tuser = usersById[++nextUserId] = {id: nextUserId};\n\tuser[source] = sourceUser;\n    }\n    return user;\n}\n\neveryauth.everymodule\n  .findUserById( function (id, callback) {\n    callback(null, usersById[id]);\n  });\n\nvar auth= {\n    development: {\n\tfacebook: {\n\t    appId: '290491051026125',\n\t    appSecret: 'b3f20e1678af9d70dfc0a4aad9f156af'\n\t},\n\tgoogle: {\n\t    clientId: '634411416057.apps.googleusercontent.com',\n\t    clientSecret: '0YvhqMI0F7Vn2dlh-sDlZrQx'\n\t},\n\ttwitter: ''\n    },\n\n    production: {\n\tfacebook: {\n\t    appId: '385877844809808',\n\t    appSecret: 'c7149334401b7bd293222ba587ef4f1b'\n\t},\n\tgoogle: {\n\t    clientId: '634411416057-3gt1246874h496k1iak4rqpvmqm99r2e.apps.googleusercontent.com',\n\t    clientSecret: 'wzBAL0PyTGm5kh9YEZ02Ygbo'\n\t},\n\ttwitter: ''\n    }\n};\n\neveryauth\n    .facebook\n    .appId(auth[env].facebook.appId)\n    .appSecret(auth[env].facebook.appSecret)\n    .findOrCreateUser( function (session, accessToken, accessTokenExtra, fbUserMetadata) {\n\treturn usersByFbId[fbUserMetadata.id] ||\n            (usersByFbId[fbUserMetadata.id] = addUser('facebook', fbUserMetadata));\n    })\n    .redirectPath('/');\n\neveryauth.google\n    .appId(auth[env].google.clientId)\n    .appSecret(auth[env].google.clientSecret)\n    .scope('https://www.googleapis.com/auth/userinfo.profile https://www.google.com/m8/feeds/')\n    .findOrCreateUser( function (sess, accessToken, extra, googleUser) {\n\tgoogleUser.refreshToken = extra.refresh_token;\n\tgoogleUser.expiresIn = extra.expires_in;\n\treturn usersByGoogleId[googleUser.id] || (usersByGoogleId[googleUser.id] = addUser('google', googleUser));\n    })\n    .redirectPath('/');"]],"start1":0,"start2":0,"length1":0,"length2":2046}]],"length":2046}
{"contributors":[],"silentsave":false,"ts":1348783946884,"patch":[[{"diffs":[[0,") {\n"],[-1,"\treturn usersByFbId[fbUserMetadata.id] ||\n            (usersByFbId[fbUserMetadata.id] = addUser('facebook'"],[1,"        checkUser.call(this"],[0,", fb"]],"start1":1386,"start2":1386,"length1":114,"length2":35},{"diffs":[[0,"etadata)"],[-1,")"],[0,";\n    })"]],"start1":1426,"start2":1426,"length1":17,"length2":16}]],"length":1966,"saved":false}
{"ts":1348783987348,"patch":[[{"diffs":[[0,"  }\n};\n\n"],[1,"function checkUser() {\n}\n\n"],[0,"everyaut"]],"start1":1185,"start2":1185,"length1":16,"length2":42},{"diffs":[[0,"ll(this,"],[1," 'facebook',"],[0," fbUserM"]],"start1":1436,"start2":1436,"length1":16,"length2":28}]],"length":2004,"saved":false}
{"ts":1348787183975,"patch":[[{"diffs":[[0,"eckUser("],[-1,") {"],[1,"source, identity) {\n    \n    // IdentityStore.find();"],[0,"\n}\n\never"]],"start1":1204,"start2":1204,"length1":19,"length2":69}]],"length":2054,"saved":false}
{"ts":1348792948676,"patch":[[{"diffs":[[0,"d-based\n"],[1,"    "],[0,"    user"]],"start1":280,"start2":280,"length1":16,"length2":20},{"diffs":[[0,"ource;\n\t"],[1,"    "],[0,"user.id "]],"start1":317,"start2":317,"length1":16,"length2":20},{"diffs":[[0,"serId;\n\t"],[1,"    "],[0,"return u"]],"start1":346,"start2":346,"length1":16,"length2":20},{"diffs":[[0,"-based\n\t"],[1,"    "],[0,"user = u"]],"start1":423,"start2":423,"length1":16,"length2":20},{"diffs":[[0,"erId};\n\t"],[1,"    "],[0,"user[sou"]],"start1":479,"start2":479,"length1":16,"length2":20},{"diffs":[[0,"odule\n  "],[1," "],[1," "],[0,".findUse"]],"start1":560,"start2":560,"length1":16,"length2":18},{"diffs":[[0,"callback) {\n"],[1,"    "],[0,"    callback"]],"start1":599,"start2":599,"length1":24,"length2":28},{"diffs":[[0,"d[id]);\n"],[1,"  "],[0,"  });\n\nv"]],"start1":642,"start2":642,"length1":16,"length2":18}]],"length":2082,"saved":false}
{"ts":1348793867386,"patch":[[{"diffs":[[0," addUser"],[-1," "],[0,""],[1,""],[0,"(source,"]],"start1":190,"start2":190,"length1":17,"length2":16},{"diffs":[[0,"source;\n"],[-1,"\t"],[1,"    "],[0,"    user"]],"start1":315,"start2":315,"length1":17,"length2":20},{"diffs":[[0,"UserId;\n"],[-1,"\t"],[1,"    "],[0,"    retu"]],"start1":347,"start2":347,"length1":17,"length2":20},{"diffs":[[0,"r;\n    }"],[1,"\n   "],[0," else { "]],"start1":397,"start2":397,"length1":16,"length2":20},{"diffs":[[0,"d-based\n"],[-1,"\t"],[1,"    "],[0,"    user"]],"start1":431,"start2":431,"length1":17,"length2":20},{"diffs":[[0,"rId] = {"],[1,"\n            "],[0,"id: next"]],"start1":473,"start2":473,"length1":16,"length2":29},{"diffs":[[0,"erId"],[-1,"};\n\t"],[1,"\n        };\n    "],[0,"    "]],"start1":504,"start2":504,"length1":12,"length2":24},{"diffs":[[0,"rymodule"],[-1,"\n    "],[0,".findUse"]],"start1":594,"start2":594,"length1":21,"length2":16},{"diffs":[[0,"serById("],[-1," "],[0,"function"],[-1," "],[0,"(id, cal"]],"start1":608,"start2":608,"length1":26,"length2":24},{"diffs":[[0,") {\n    "],[-1,"   "],[-1," "],[0,"callback"]],"start1":637,"start2":637,"length1":20,"length2":16},{"diffs":[[0,"d[id]);\n"],[-1,"    "],[0,"});\n\nvar"]],"start1":668,"start2":668,"length1":20,"length2":16},{"diffs":[[0,"var auth"],[1," "],[0,"= {\n    "]],"start1":681,"start2":681,"length1":16,"length2":17},{"diffs":[[0,"elopment: {\n"],[-1,"\t"],[1,"        "],[0,"facebook: {\n"]],"start1":701,"start2":701,"length1":25,"length2":32},{"diffs":[[0,"    facebook: {\n"],[-1,"\t"],[1,"        "],[0,"    appId: '2904"]],"start1":717,"start2":717,"length1":33,"length2":40},{"diffs":[[0,"26125',\n"],[-1,"\t"],[1,"        "],[0,"    appS"]],"start1":763,"start2":763,"length1":17,"length2":24},{"diffs":[[0,"f156af'\n"],[-1,"\t},\n\t"],[1,"        },\n        "],[0,"google: "]],"start1":821,"start2":821,"length1":21,"length2":35},{"diffs":[[0,"      google: {\n"],[-1,"\t"],[1,"        "],[0,"    clientId: '6"]],"start1":842,"start2":842,"length1":33,"length2":40},{"diffs":[[0,"ercontent.com',\n"],[-1,"\t"],[1,"        "],[0,"    clientSecret"]],"start1":907,"start2":907,"length1":33,"length2":40},{"diffs":[[0,"DlZrQx'\n"],[-1,"\t},\n\t"],[1,"        },\n        "],[0,"twitter:"]],"start1":968,"start2":968,"length1":21,"length2":35},{"diffs":[[0,"tion: {\n"],[-1,"\t"],[1,"        "],[0,"facebook"]],"start1":1025,"start2":1025,"length1":17,"length2":24},{"diffs":[[0,"facebook: {\n"],[-1,"\t"],[1,"        "],[0,"    appId: '"]],"start1":1041,"start2":1041,"length1":25,"length2":32},{"diffs":[[0,"09808',\n"],[-1,"\t"],[1,"      "],[0,"    "],[1,"  "],[0,"appSecre"]],"start1":1083,"start2":1083,"length1":21,"length2":28},{"diffs":[[0,"ef4f1b'\n"],[-1,"\t},\n\t"],[1,"        },\n        "],[0,"google: "]],"start1":1141,"start2":1141,"length1":21,"length2":35},{"diffs":[[0,"ogle: {\n"],[-1,"\t"],[1,"       "],[0,"    "],[1," "],[0,"clientId"]],"start1":1170,"start2":1170,"length1":21,"length2":28},{"diffs":[[0,"t.com',\n"],[-1,"\t"],[1,"        "],[0,"    clie"]],"start1":1268,"start2":1268,"length1":17,"length2":24},{"diffs":[[0,"bo'\n"],[-1,"\t},\n\t"],[1,"        },\n        "],[0,"twit"]],"start1":1325,"start2":1325,"length1":13,"length2":27},{"diffs":[[0,") {\n"],[-1,"    \n"],[0,"    "]],"start1":1405,"start2":1405,"length1":13,"length2":8},{"diffs":[[0,"veryauth"],[-1,"\n    "],[0,".faceboo"]],"start1":1442,"start2":1442,"length1":21,"length2":16},{"diffs":[[0,"facebook"],[-1,"\n    "],[0,".appId(a"]],"start1":1451,"start2":1451,"length1":21,"length2":16},{"diffs":[[0,"k.appId)"],[-1,"\n    "],[0,".appSecr"]],"start1":1483,"start2":1483,"length1":21,"length2":16},{"diffs":[[0,"pSecret)"],[-1,"\n    "],[0,".findOrC"]],"start1":1523,"start2":1523,"length1":21,"length2":16},{"diffs":[[0,"rCreateUser("],[-1," "],[0,"function"],[-1," "],[0,"(session, ac"]],"start1":1537,"start2":1537,"length1":34,"length2":32},{"diffs":[[0,"data) {\n"],[-1,"    "],[0,"    chec"]],"start1":1608,"start2":1608,"length1":20,"length2":16},{"diffs":[[0,"adata);\n"],[-1,"    })\n    "],[1,"})"],[0,".redirec"]],"start1":1662,"start2":1662,"length1":27,"length2":18},{"diffs":[[0,"h.google"],[-1,"\n    "],[0,".appId(a"]],"start1":1701,"start2":1701,"length1":21,"length2":16},{"diffs":[[0,"lientId)"],[-1,"\n    "],[0,".appSecr"]],"start1":1734,"start2":1734,"length1":21,"length2":16},{"diffs":[[0,"tSecret)"],[-1,"\n    "],[0,".scope('"]],"start1":1775,"start2":1775,"length1":21,"length2":16},{"diffs":[[0,"feeds/')"],[-1,"\n    "],[0,".findOrC"]],"start1":1866,"start2":1866,"length1":21,"length2":16},{"diffs":[[0,"ser("],[-1," "],[0,"function"],[-1," "],[0,"(ses"]],"start1":1888,"start2":1888,"length1":18,"length2":16},{"diffs":[[0,"User) {\n"],[-1,"\t"],[1,"    "],[0,"googleUs"]],"start1":1933,"start2":1933,"length1":17,"length2":20},{"diffs":[[0,"_token;\n"],[-1,"\t"],[1,"    "],[0,"googleUs"]],"start1":1984,"start2":1984,"length1":17,"length2":20},{"diffs":[[0,"in;\n"],[-1,"\t"],[1,"    "],[0,"retu"]],"start1":2033,"start2":2033,"length1":9,"length2":12},{"diffs":[[0,"));\n"],[-1,"    })\n    "],[1,"})"],[0,".red"]],"start1":2144,"start2":2144,"length1":19,"length2":10}]],"length":2169,"saved":false}
{"ts":1348794144466,"patch":[[{"diffs":[[0,"find();\n"],[1,"    console.log(source);\n    console.log(identity);\n"],[0,"}\n\nevery"]],"start1":1430,"start2":1430,"length1":16,"length2":68}]],"length":2221,"saved":false}
{"ts":1348796286168,"patch":[[{"diffs":[[0,"eryauth');\n\n"],[1,"module.exports = function(app) {\n    "],[0,"everyauth.he"]],"start1":27,"start2":27,"length1":24,"length2":61},{"diffs":[[0,"s(app);\n"],[1,"    "],[0,"everyaut"]],"start1":96,"start2":96,"length1":16,"length2":20},{"diffs":[[0,"ser));\n}).redirectPath('/');"],[1,"\n\n}"]],"start1":2234,"start2":2234,"length1":28,"length2":31}]],"length":2265,"saved":false}
{"ts":1348796416303,"patch":[[{"diffs":[[0," true;\n\n"],[1,"    "],[0,"var user"]],"start1":125,"start2":125,"length1":16,"length2":20},{"diffs":[[0,"ersByFbId = {};\n"],[1,"    "],[0,"var usersById = "]],"start1":143,"start2":143,"length1":32,"length2":36},{"diffs":[[0,"d = {};\n"],[1,"    "],[0,"var user"]],"start1":175,"start2":175,"length1":16,"length2":20},{"diffs":[[0," = {};\n\n"],[1,"    "],[0,"var next"]],"start1":206,"start2":206,"length1":16,"length2":20},{"diffs":[[0,"d = 0;\n\n"],[1,"    "],[0,"function"]],"start1":231,"start2":231,"length1":16,"length2":20},{"diffs":[[0,"User) {\n    "],[1,"   "],[1," "],[0,"var user;\n  "]],"start1":274,"start2":274,"length1":24,"length2":28},{"diffs":[[0,"  var user;\n"],[1,"    "],[0,"    if (argu"]],"start1":288,"start2":288,"length1":24,"length2":28},{"diffs":[[0,"sed\n        "],[1,"  "],[1,"  "],[0,"user = sourc"]],"start1":352,"start2":352,"length1":24,"length2":28},{"diffs":[[0,"ce;\n        "],[1,"    "],[0,"user.id = ++"]],"start1":392,"start2":392,"length1":24,"length2":28},{"diffs":[[0,"Id;\n        "],[1,"  "],[1,"  "],[0,"return users"]],"start1":428,"start2":428,"length1":24,"length2":28},{"diffs":[[0,"Id] = user;\n"],[1,"    "],[0,"    }\n    el"]],"start1":469,"start2":469,"length1":24,"length2":28},{"diffs":[[0,"  }\n    "],[1," "],[1,"   "],[0,"else { /"]],"start1":487,"start2":487,"length1":16,"length2":20},{"diffs":[[0,"-password-based\n"],[1,"    "],[0,"        user = u"]],"start1":512,"start2":512,"length1":32,"length2":36},{"diffs":[[0,"        "],[1,"    "],[0,"id: next"]],"start1":579,"start2":579,"length1":16,"length2":20},{"diffs":[[0,"        "],[1,"   "],[1," "],[0,"};\n"],[1,"    "],[0,"        "]],"start1":606,"start2":606,"length1":19,"length2":27},{"diffs":[[0,"ceUser;\n    "],[-1,"}\n"],[1,"    }\n    "],[0,"    return u"]],"start1":652,"start2":652,"length1":26,"length2":34},{"diffs":[[0,"n user;\n"],[-1,"}\n\n"],[1,"    }\n\n    "],[0,"everyaut"]],"start1":683,"start2":683,"length1":19,"length2":27},{"diffs":[[0,"callback) {\n"],[1,"    "],[0,"    callback"]],"start1":750,"start2":750,"length1":24,"length2":28},{"diffs":[[0,"]);\n"],[1,"    "],[0,"});\n\n"],[1,"    "],[0,"var "]],"start1":797,"start2":797,"length1":13,"length2":21},{"diffs":[[0,"= {\n    "],[1," "],[1,"   "],[0,"developm"]],"start1":823,"start2":823,"length1":16,"length2":20},{"diffs":[[0,"ment: {\n        "],[1," "],[1,"   "],[0,"facebook: {\n    "]],"start1":842,"start2":842,"length1":32,"length2":36},{"diffs":[[0,"    facebook: {\n"],[1,"    "],[0,"            appI"]],"start1":858,"start2":858,"length1":32,"length2":36},{"diffs":[[0,"5',\n            "],[1,"    "],[0,"appSecret: 'b3f2"]],"start1":912,"start2":912,"length1":32,"length2":36},{"diffs":[[0,"f156af'\n        "],[-1,"},\n"],[1,"    },\n    "],[0,"        google: "]],"start1":970,"start2":970,"length1":35,"length2":43},{"diffs":[[0,": {\n            "],[1,"  "],[1,"  "],[0,"clientId: '63441"]],"start1":1011,"start2":1011,"length1":32,"length2":36},{"diffs":[[0,"m',\n            "],[1,"    "],[0,"clientSecret: '0"]],"start1":1080,"start2":1080,"length1":32,"length2":36},{"diffs":[[0,"DlZrQx'\n        "],[1,"  "],[1,"  "],[0,"},\n"],[1,"    "],[0,"        twitter:"]],"start1":1133,"start2":1133,"length1":35,"length2":43},{"diffs":[[0,"    "],[1," "],[1,"   "],[0,"},\n\n"],[1,"    "],[0,"    "]],"start1":1180,"start2":1180,"length1":12,"length2":20},{"diffs":[[0,"tion: {\n        "],[1," "],[1,"   "],[0,"facebook: {\n    "]],"start1":1206,"start2":1206,"length1":32,"length2":36},{"diffs":[[0,"    facebook: {\n"],[1,"    "],[0,"            appI"]],"start1":1222,"start2":1222,"length1":32,"length2":36},{"diffs":[[0,"8',\n            "],[1,"    "],[0,"appSecret: 'c714"]],"start1":1276,"start2":1276,"length1":32,"length2":36},{"diffs":[[0,"ef4f1b'\n        "],[-1,"},\n"],[1,"    },\n    "],[0,"        google: "]],"start1":1334,"start2":1334,"length1":35,"length2":43},{"diffs":[[0,": {\n            "],[1,"   "],[1," "],[0,"clientId: '63441"]],"start1":1375,"start2":1375,"length1":32,"length2":36},{"diffs":[[0,"m',\n            "],[1,"    "],[0,"clientSecret: 'w"]],"start1":1477,"start2":1477,"length1":32,"length2":36},{"diffs":[[0,"02Ygbo'\n        "],[-1,"},\n"],[1,"    },\n    "],[0,"        twitter:"]],"start1":1530,"start2":1530,"length1":35,"length2":43},{"diffs":[[0,"    "],[1," "],[-1,"}\n};\n\n"],[1,"   }\n    };\n\n    "],[0,"func"]],"start1":1577,"start2":1577,"length1":14,"length2":26},{"diffs":[[0,"identity) {\n"],[1,"    "],[0,"    // Ident"]],"start1":1626,"start2":1626,"length1":24,"length2":28},{"diffs":[[0,"find();\n"],[1,"    "],[0,"    cons"]],"start1":1663,"start2":1663,"length1":16,"length2":20},{"diffs":[[0,"ource);\n"],[1,"    "],[0,"    cons"]],"start1":1692,"start2":1692,"length1":16,"length2":20},{"diffs":[[0,"ntity);\n"],[-1,"}\n\n"],[1,"    }\n\n    "],[0,"everyaut"]],"start1":1723,"start2":1723,"length1":19,"length2":27},{"diffs":[[0,"Metadata) {\n"],[1,"    "],[0,"    checkUse"]],"start1":1905,"start2":1905,"length1":24,"length2":28},{"diffs":[[0,"adata);\n"],[1,"    "],[0,"}).redir"]],"start1":1967,"start2":1967,"length1":16,"length2":20},{"diffs":[[0,"('/');\n\n"],[1,"    "],[0,"everyaut"]],"start1":1994,"start2":1994,"length1":16,"length2":20},{"diffs":[[0,"User) {\n    "],[1,"  "],[1,"  "],[0,"googleUser.r"]],"start1":2246,"start2":2246,"length1":24,"length2":28},{"diffs":[[0,"_token;\n"],[1,"    "],[0,"    goog"]],"start1":2301,"start2":2301,"length1":16,"length2":20},{"diffs":[[0,"res_in;\n"],[1,"    "],[0,"    retu"]],"start1":2350,"start2":2350,"length1":16,"length2":20},{"diffs":[[0,"User));\n"],[1,"    "],[0,"}).redir"]],"start1":2465,"start2":2465,"length1":16,"length2":20}]],"length":2501,"saved":false}
{"ts":1348796529194,"patch":[[{"diffs":[[0,"tion(app) {\n"],[1,"    var env = app.env;\n    \n"],[0,"    everyaut"]],"start1":60,"start2":60,"length1":24,"length2":52}]],"length":2529,"saved":false}
{"ts":1348798741639,"patch":[[{"diffs":[[0,"    "],[-1,"// IdentityStore.find("],[1,"var promise = this.Promise();\n        IdentityStore.findOne({ source: source, user_id: identity.id }, function(err, r) {\n            if (r) {\n                promise.fulfill(r);\n            }\n        }"],[0,");\n "]],"start1":1670,"start2":1670,"length1":30,"length2":209},{"diffs":[[0,"ntity);\n"],[1,"        return promise;\n        \n"],[0,"    }\n\n "]],"start1":1930,"start2":1930,"length1":16,"length2":49},{"diffs":[[0,"data) {\n"],[-1,""],[0,"        "],[1,"return "],[0,"checkUse"]],"start1":2149,"start2":2149,"length1":24,"length2":31}]],"length":2748,"saved":false}
{"ts":1348798827003,"patch":[[{"diffs":[[0,"    if ("],[1,"er"],[0,"r) {\n   "]],"start1":1803,"start2":1803,"length1":16,"length2":18},{"diffs":[[0,"ise."],[-1,"fulfill(r"],[1,"error(['failed']"],[0,");\n "]],"start1":1838,"start2":1838,"length1":17,"length2":24},{"diffs":[[0,"    "],[-1,"});\n        console.log(source);\n        console.log(identity"],[1,"    if (r) {\n                promise.fulfill(r);\n            }\n        }"],[0,");\n "]],"start1":1879,"start2":1879,"length1":69,"length2":80},{"diffs":[[0,"promise;"],[-1,"\n"],[0,"        "]],"start1":1973,"start2":1973,"length1":17,"length2":16}]],"length":2767,"saved":false}
{"ts":1348798861696,"patch":[[{"diffs":[[0,"ill(r);\n"],[1,"            } else {\n                addUser(source, identity);\n"],[0,"        "]],"start1":1924,"start2":1924,"length1":16,"length2":80}]],"length":2831,"saved":false}
{"ts":1348798870921,"patch":[[{"diffs":[[0,"         addUser"],[-1,"("],[1,".call(this, "],[0,"source, identity"]],"start1":1960,"start2":1960,"length1":33,"length2":44}]],"length":2842,"saved":false}
{"ts":1348799461709,"patch":[[{"diffs":[[0,"uth');\n\n"],[1,"var IdentityStore = Store('Identity', {\n    source: { type: String },\n    user_id: { type: String }\n    date: { type: Date, default: Date.now }\n});\n\n"],[0,"module.e"]],"start1":31,"start2":31,"length1":16,"length2":165},{"diffs":[[0,"Id = 0;\n"],[1,"    "],[0,"\n    fun"]],"start1":407,"start2":407,"length1":16,"length2":20},{"diffs":[[0,"mise();\n"],[1,"\n"],[0,"        "]],"start1":1849,"start2":1849,"length1":16,"length2":17}]],"length":2996,"saved":false}
{"ts":1348799464042,"patch":[[{"diffs":[[0,"String }"],[1,","],[0,"\n    dat"]],"start1":130,"start2":130,"length1":16,"length2":17}]],"length":2997,"saved":false}
{"ts":1348799502795,"patch":[[{"diffs":[[0,"te, "],[1,"'"],[0,"default"],[1,"'"],[0,": Da"]],"start1":160,"start2":160,"length1":15,"length2":17}]],"length":2999,"saved":false}
{"ts":1348800000194,"patch":[[{"diffs":[[0,"ce, "],[-1,"sourceUser) {\n        var user;\n        if (arguments.length === 1) { // password-based\n            user = sourceUser = source;\n            user.id = ++nextUserId;\n            return usersById[nextUserId] = user;\n        }\n        else { // non-password-based\n            user = usersById[++nextUserId] = {\n                id: nextUserId\n            };\n            user[source] = sourceUser;\n        }"],[1,"identity) {\n        var user;\n        "],[0,"\n   "]],"start1":448,"start2":448,"length1":409,"length2":46},{"diffs":[[0,"        "],[1,"return "],[0,"addUser."]],"start1":1755,"start2":1755,"length1":16,"length2":23}]],"length":2643,"saved":false}
{"ts":1348800021820,"patch":[[{"diffs":[[0,"  var user;\n"],[1,"        var promise = this.Promise();\n"],[0,"        \n   "]],"start1":470,"start2":470,"length1":24,"length2":62}]],"length":2681,"saved":false}
{"ts":1348808769497,"patch":[[{"diffs":[[0,"();\n        "],[1,"var model = new IdentityStore({\n            source: source,\n            user_id: identity.id\n        });"],[0,"\n        ret"]],"start1":516,"start2":516,"length1":24,"length2":128}]],"length":2785,"saved":false}
{"ts":1348808941686,"patch":[[{"diffs":[[0,".id\n        });\n"],[1,"        model.save(function(err, r) {\n            if (err) {\n                promise.fail(err);\n            }\n        });\n"],[0,"        return u"]],"start1":617,"start2":617,"length1":32,"length2":154},{"diffs":[[0," return "],[-1,"u"],[1,"promi"],[0,"se"],[-1,"r"],[0,";\n    }\n"]],"start1":762,"start2":762,"length1":20,"length2":23}]],"length":2910,"saved":false}
{"ts":1348809008332,"patch":[[{"diffs":[[0,".fail(err);\n"],[1,"            } else {\n                promise.fulfill(r);\n"],[0,"            "]],"start1":717,"start2":717,"length1":24,"length2":81}]],"length":2967,"saved":false}
{"ts":1348809028376,"patch":[[{"diffs":[[0,"ise."],[-1,"error"],[1,"fulfill"],[0,"(['f"]],"start1":1956,"start2":1956,"length1":13,"length2":15}]],"length":2969,"saved":false}
{"ts":1348809097007,"patch":[[{"diffs":[[0,"e;\n\n"],[-1,"    var usersByFbId = {};\n"],[0,"    "]],"start1":309,"start2":309,"length1":34,"length2":8},{"diffs":[[0," {};"],[-1,"\n\n    var nextUserId = 0;"],[0,"\n   "]],"start1":362,"start2":362,"length1":33,"length2":8}]],"length":2918,"saved":false}
{"ts":1348809380631,"patch":[[{"diffs":[[0,"Metadata) {\n"],[1,"        session.user = fbUserMetadata;\n"],[0,"        retu"]],"start1":2315,"start2":2315,"length1":24,"length2":63}]],"length":2957,"saved":false}
{"ts":1348809405728,"patch":[[{"diffs":[[0,"session."],[1,"_"],[0,"user = f"]],"start1":2335,"start2":2335,"length1":16,"length2":17}]],"length":2958,"saved":false}
{"ts":1348809436480,"patch":[[{"diffs":[[0,"yauth');"],[1,"\nvar Store = require('./Store');"],[0,"\n\nvar Id"]],"start1":29,"start2":29,"length1":16,"length2":48}]],"length":2990,"saved":false}
{"ts":1348809565470,"patch":[[{"diffs":[[0,"     }\n        }"],[1,".call(this)"],[0,");\n        retur"]],"start1":2122,"start2":2122,"length1":32,"length2":43}]],"length":3001,"saved":false}
{"ts":1348809572207,"patch":[[{"diffs":[[0,"      }."],[-1,"call"],[1,"bind"],[0,"(this));"]],"start1":2131,"start2":2131,"length1":20,"length2":20}]],"length":3001,"saved":false}
{"ts":1348809601480,"patch":[[{"diffs":[[0,"mise();\n"],[1,"        var self = this;"],[0,"\n       "]],"start1":1794,"start2":1794,"length1":16,"length2":40},{"diffs":[[0,"er.call("],[-1,"this"],[1,"self"],[0,", source"]],"start1":2106,"start2":2106,"length1":20,"length2":20},{"diffs":[[0,"   }"],[-1,".bind(this)"],[0,");\n "]],"start1":2158,"start2":2158,"length1":19,"length2":8}]],"length":3014,"saved":false}
{"ts":1348809725921,"patch":[[{"diffs":[[0,") {\n"],[-1,"        var user;\n"],[0,"    "]],"start1":441,"start2":441,"length1":26,"length2":8}]],"length":2996,"saved":false}
{"ts":1348809991439,"patch":[[{"diffs":[[0,"= this;\n"],[1,"        console.log('\\n\\ncheckUser\\n\\n');\n"],[0,"        "]],"start1":1801,"start2":1801,"length1":16,"length2":58}]],"length":3038,"saved":false}
{"ts":1348810617909,"patch":[[{"diffs":[[0,"   if (r) {\n"],[1,"                r.id = r._id;\n"],[0,"            "]],"start1":2033,"start2":2033,"length1":24,"length2":54}]],"length":3068,"saved":false}
{"ts":1348810729605,"patch":[[{"diffs":[[0,"   if (r) {\n"],[1,"                console.log('\\n\\ncheckUser\\n\\n');\n"],[0,"            "]],"start1":2033,"start2":2033,"length1":24,"length2":74}]],"length":3118,"saved":false}
{"ts":1348810743347,"patch":[[{"diffs":[[0,"ole.log("],[-1,"'\\n\\ncheckUser\\n\\n'"],[1,"r"],[0,");\n     "]],"start1":2065,"start2":2065,"length1":35,"length2":17}]],"length":3100,"saved":false}
{"ts":1348811172276,"patch":[[{"diffs":[[0,"romise.fulfill(r"],[1,".toObject()"],[0,");\n            }"]],"start1":2124,"start2":2124,"length1":32,"length2":43}]],"length":3111,"saved":false}
